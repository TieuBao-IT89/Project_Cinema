@model IEnumerable<Project_Cinema.Models.MovieModel>

@{
    var nowShowing = Model.Where(movie => movie.ReleaseDate == null || movie.ReleaseDate <= DateTime.Today).ToList();
    var comingSoon = Model.Where(movie => movie.ReleaseDate != null && movie.ReleaseDate > DateTime.Today).ToList();
}

<!-- Page Title Banner -->
<section class="page-banner">
    <div class="page-banner-overlay"></div>
    <div class="page-banner-content">
        <div class="container">
            <h1 class="page-title">Danh sách phim</h1>
            <p class="page-subtitle">Khám phá bộ sưu tập phim đa dạng và phong phú</p>
        </div>
    </div>
</section>

<!-- Movies Tabs -->
<section class="movies-tabs-section">
    <div class="container">
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('now-showing')">
                <i class="fas fa-film"></i> Phim đang chiếu
            </button>
            <button class="tab-btn" onclick="switchTab('coming-soon')">
                <i class="fas fa-calendar-alt"></i> Phim sắp chiếu
            </button>
        </div>
    </div>
</section>

<!-- Now Showing Movies -->
<section id="now-showing" class="movies-list-section active-tab">
    <div class="container">
        <div class="movies-header">
            <h2 class="section-title">Phim đang chiếu</h2>
            <div class="movies-count">
                <span id="now-showing-count">@nowShowing.Count</span> phim
            </div>
        </div>

        <div class="movies-grid" id="now-showing-grid">
            @foreach (var movie in nowShowing)
            {
                <div class="movie-card">
                    <div class="movie-poster">
                        <img src="@(string.IsNullOrWhiteSpace(movie.PosterUrl) ? $"https://via.placeholder.com/300x450?text={movie.Title}" : movie.PosterUrl)" alt="@movie.Title">
                        <div class="movie-overlay">
                            <a asp-controller="Movie" asp-action="Details" asp-route-id="@movie.MovieId" class="btn btn-sm">Xem chi tiết</a>
                            <a asp-controller="Showtime" asp-action="Index" asp-route-movieId="@movie.MovieId" class="btn btn-sm btn-primary">Đặt vé</a>
                        </div>
                    </div>
                    <div class="movie-info">
                        <h3 class="movie-name">@movie.Title</h3>
                        <div class="movie-details">
                            <span class="genre">@movie.Language</span>
                            <span class="duration">@movie.DurationMin phút</span>
                        </div>
                        <div class="movie-meta-info">
                            <span class="age-rating">@movie.AgeRating</span>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</section>

<!-- Coming Soon Movies -->
<section id="coming-soon" class="movies-list-section">
    <div class="container">
        <div class="movies-header">
            <h2 class="section-title">Phim sắp chiếu</h2>
            <div class="movies-count">
                <span id="coming-soon-count">@comingSoon.Count</span> phim
            </div>
        </div>

        <div class="movies-grid" id="coming-soon-grid">
            @foreach (var movie in comingSoon)
            {
                <div class="movie-card">
                    <div class="movie-poster">
                        <img src="@(string.IsNullOrWhiteSpace(movie.PosterUrl) ? $"https://via.placeholder.com/300x450?text={movie.Title}" : movie.PosterUrl)" alt="@movie.Title">
                        <div class="coming-soon-badge">Sắp chiếu</div>
                        <div class="movie-overlay">
                            <a asp-controller="Movie" asp-action="Details" asp-route-id="@movie.MovieId" class="btn btn-sm">Xem chi tiết</a>
                        </div>
                    </div>
                    <div class="movie-info">
                        <h3 class="movie-name">@movie.Title</h3>
                        <div class="movie-details">
                            <span class="genre">@movie.Language</span>
                            <span class="release-date">
                                <i class="fas fa-calendar"></i>
                                @(movie.ReleaseDate?.ToString("dd/MM/yyyy") ?? "Chưa cập nhật")
                            </span>
                        </div>
                        <div class="movie-meta-info">
                            <span class="age-rating">@movie.AgeRating</span>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</section>